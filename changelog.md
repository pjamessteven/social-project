# Changelog

## [2026-01-31] - Add Korean (KO) Translation File

### Translation Updates
- **Korean Translation File**: Added complete Korean translation file `messages/ko.json`
  - Full translation of all UI strings, navigation, forms, and content (800+ lines)
  - Careful attention to gender terminology in Korean:
    - "Detransitioner" → "디트랜지셔너" (transliteration, gender-neutral)
    - "Transgender" → "트랜스젠더" (transliteration, widely used)
    - "Male/Female" → "남성/여성" (for biological sex), "남자/여자" (for social gender)
    - "Sex" → "성" (biological), "Gender" → "성별" (social construct)
  - Gender-neutral language used throughout, as Korean doesn't mark gender grammatically
  - All sections translated including metadata, UI, definitions, chat, stories, videos, support resources, and legal terms

### Gender Terminology Notes (Korean)
Korean translations carefully handle the language's unique approach to gender:
- **"디트랜지셔너"** (detransitioner) - gender-neutral transliteration
- **"트랜스젠더"** (transgender) - standard transliteration used in Korea
- **"남성/여성"** (male/female) - formal terms for biological sex
- **"남자/여자"** (man/woman) - common terms for social gender
- **"성별 불쾌감"** (gender dysphoria) - standard Korean medical terminology
- **"성별 정체성"** (gender identity) - widely understood academic term
- **"디트랜지션"** (detransition) - transliteration, clear and direct
- **"데시스턴스"** (desistance) - transliteration of psychological term
- **"성별 비순응"** (gender non-conformity) - descriptive translation
- **"성별 확정적 치료"** (gender-affirming care) - medical terminology
- **"성별 탐구적 치료"** (gender-exploratory therapy) - clinical term
- **"논바이너리"** (non-binary) - transliteration, commonly used
- Honorific speech levels (존칭) used appropriately throughout

### Technical Details
- Korean locale (ko) integrated into existing language system
- Translation follows standard Korean conventions (South Korea)
- All gender-related medical and psychological terms use appropriate Korean terminology
- Korean's lack of grammatical gender makes translation straightforward for gender agreement
- Routes preserved (not translated) for URL consistency
- Character encoding supports Korean Hangul characters (UTF-8)

## [2026-01-31] - Add Chinese Simplified (zh-cn) Translation File

### Translation Updates
- **Chinese Simplified Translation File**: Added complete Chinese Simplified translation file `messages/zh-cn.json`
  - Full translation of all UI strings, navigation, forms, and content (800+ lines)
  - Careful attention to gender terminology in Chinese, ensuring culturally appropriate expressions:
    - "Detransitioner" → "去过渡者" (qù guòdù zhě)
    - "Transgender" → "跨性别" (kuà xìngbié)
    - "Male/Female" → "男性/女性" (nánxìng/nǚxìng) for biological sex
    - "Sex/Gender" → "生理性别/性别" (shēnglǐ xìngbié/xìngbié) maintaining distinction
  - All sections translated including:
    - Metadata and SEO descriptions
    - Home page content and question starters
    - Navigation and header elements
    - Definitions and terminology explanations
    - Chat interface and conversation handling
    - Stories, videos, and studies pages
    - Support resources and therapy information
    - Privacy policy and terms of service
    - Charts and data visualizations
    - Contact form and error messages

### Gender Terminology Notes (Chinese Simplified)
Chinese translations carefully handle gender concepts throughout:
- **"去过渡者"** (qù guòdù zhě) (detransitioner) - neutral term without grammatical gender
- **"跨性别"** (kuà xìngbié) (transgender) - standard term
- **"男性/女性"** (nánxìng/nǚxìng) (male/female) - used for biological sex
- **"性别"** (xìngbié) (gender/sex) - context determines meaning
- **"生理性别"** (shēnglǐ xìngbié) (biological sex) - anatomical/biological distinction
- **"社会性别"** (shèhuì xìngbié) (social gender) - social construct distinction
- **"性别认同"** (xìngbié rèntóng) (gender identity) - internal sense of gender
- **"性别焦虑"** (xìngbié jiāolǜ) (gender dysphoria) - distress from gender/sex mismatch
- **"性别不一致"** (xìngbié bù yīzhì) (gender non-conformity) - not conforming to stereotypes
- **"变性"** (biànxìng) (sex change/transition) - medical terminology
- **"去过渡/脱跨"** (qù guòdù/tuō kuà) (detransition) - descriptive terms
- **"停止"** (tíngzhǐ) (desistance) - cessation of identification
- **"性别肯定护理"** (xìngbié kěndìng hùlǐ) (gender-affirming care)
- **"性别探索性治疗"** (xìngbié tànsuǒ xìng zhìliáo) (gender-exploratory therapy)
- **"AFAB/AMAB"** → "出生时被指定为女性/男性" (chūshēng shí bèi zhǐdìng)
- **"非二元"** (fēi èryuán) (non-binary)
- **"顺性别"** (shùn xìngbié) (cisgender)

### Technical Details
- Chinese Simplified locale (zh-cn) ready for integration into language selector
- Translation follows Mainland Chinese conventions
- All gender-related medical and psychological terms use appropriate Chinese terminology
- Chinese is a gender-neutral language grammatically (no "he/she" pronoun distinction), requiring careful contextual handling
- Routes translated for SEO-friendly Chinese URLs

## [2026-01-31] - Add French (FR) Translation File

### Translation Updates
- **French Translation File**: Added complete French translation file `messages/fr.json`
  - Full translation of all UI strings, navigation, forms, and content (800+ lines)
  - Careful attention to gender terminology in French, ensuring correct grammatical agreement:
    - "Detransitioner" → "personne ayant fait une détransition" (gender-neutral, respectful)
    - "Transgender" → "transgenre" (invariable)
    - "Male/Female" → "masculin/féminin" for biological sex, "homme/femme" for social gender
    - "Trans woman/trans man" → "femme trans/homme trans" (correct French word order)
  - Gender-inclusive language used throughout with careful attention to:
    - Article agreement (le/la, un/une) with gendered nouns
    - Adjective agreement in gender and number
    - Professional titles with both forms (chercheur/chercheuse)
  - All sections translated including:
    - Metadata and SEO descriptions
    - Home page content and question starters
    - Navigation and header elements
    - Definitions and terminology explanations
    - Chat interface and conversation handling
    - Stories, videos, and studies pages
    - Support resources and therapy information
    - Privacy policy and terms of service
    - Charts and data visualizations
    - Contact form and error messages

### Gender Terminology Notes (French)
French translations carefully handle grammatical gender agreement:
- **"Personne ayant fait une détransition"** (detransitioner) - gender-neutral, respectful phrasing
- **"Transgenre"** (transgender) - invariable term used as both adjective and noun
- **"Mâle/Femelle"** (male/female) - used for biological sex in medical contexts
- **"Masculin/Féminin"** (masculine/feminine) - used for gender categories
- **"Homme/Femme"** (man/woman) - social gender identities
- **"Dysphorie de genre"** (gender dysphoria) - standard French medical terminology
- **"Identité de genre"** (gender identity) - widely understood term
- **"Détransition"** (detransition) - clear, direct translation
- **"Désistance"** (desistance) - appropriate psychological term
- **"Non-conformité de genre"** (gender non-conformity) - descriptive translation
- **"Soins d'affirmation de genre"** (gender-affirming care) - medical terminology
- **"Thérapie d'exploration de genre"** (gender-exploratory therapy) - clinical term
- **"Non-binaire"** (non-binary) - commonly used term
- Pronouns (il/elle/iel) preserved with French grammatical context

### Technical Details
- French locale (fr) integrated into existing language system
- Translation follows standard French conventions (France)
- All gender-related medical and psychological terms use appropriate French terminology
- Careful attention to article and adjective agreement throughout (le/la, un/une)
- Routes preserved (not translated) for URL consistency
- Character encoding supports French accented characters (UTF-8)

## [2026-01-30] - Add Portuguese (PT) Translation File

### Translation Updates
- **Portuguese Translation File**: Added complete Portuguese translation file `messages/pt.json`
  - Full translation of all UI strings, navigation, forms, and content
  - Careful attention to gender terminology in Portuguese, a highly gendered language
  - All gender terms properly translated with correct grammatical agreement:
    - "Detransitioner" → "detransicionador(a)" (male/female forms)
    - "Transgender" → "transgênero" (invariable)
    - "Male/Female" → "homem/mulher" or "masculino/feminino" (context-dependent)
    - Gender-neutral phrasing used where appropriate
  - All 800+ lines translated including:
    - Metadata and SEO descriptions
    - Home page content and question starters
    - Navigation and header elements
    - Definitions and terminology explanations
    - Chat interface and conversation handling
    - Stories, videos, and studies pages
    - Support resources and therapy information
    - Privacy policy and terms of service
    - Charts and data visualizations
    - Contact form and error messages

### Gender Terminology Notes (Portuguese)
Portuguese translations carefully handle gender agreement throughout:
- **"Detransicionador/Detransicionadora"** (detransitioner) - gendered forms for male/female
- **"Transgênero"** (transgender) - invariable term
- **"Homem/Mulher"** (male/female) - used for biological sex
- **"Masculino/Feminino"** (masculine/feminine) - used for gender categories
- **"Disforia de gênero"** (gender dysphoria) - standard medical terminology
- **"Identidade de gênero"** (gender identity) - widely understood term
- **"Desransição"** (detransition) - clear translation
- **"Desistência"** (desistance) - appropriate psychological term
- **"Não-conformidade de gênero"** (gender non-conformity) - descriptive translation
- **"Atendimento de afirmação de gênero"** (gender-affirming care) - medical terminology
- **"Terapia exploratória de gênero"** (gender-exploratory therapy) - clinical term
- **"TERF"** - preserved as technical term with explanation
- **"Pronomes"** (pronouns) - grammatical agreement maintained

### Technical Details
- Portuguese locale (pt) ready for integration into language selector
- Translation follows Brazilian Portuguese conventions
- All gender-related medical and psychological terms use appropriate Portuguese terminology
- Careful attention to article and adjective agreement throughout (o/a, um/uma)
- Routes translated for SEO-friendly Portuguese URLs

## [2026-01-30] - Reduce Supported Languages from 32 to 3

### Internationalization
- **Language Support Reduction**: Updated application to only support 3 languages (English, Spanish, French) instead of 32
  - Updated `i18n/locales.ts` to only include English, Spanish, and French
  - Updated `i18n/routing.ts` pathnames to only include translations for 3 languages
  - Updated sitemap generation to only include 3 languages
  - Added missing "questionTabs" translations to French and Spanish translation files

### Components
- **SettingsMenu**: Now only shows 3 languages in language selector dropdown
- **QuestionTabs**: Added missing translations for French and Spanish versions

### Technical Details
- Removed unused language definitions and translations
- Updated type definitions to reflect reduced language support
- Fixed sitemap generation to handle mixed string/object pathname values

## [2026-01-30] - Add Auto Theme Option to Settings Menu

### Features
- **Auto Theme Support**: Added "Auto" option to theme selector that follows system theme preference
  - Defaults to system theme on first app load (when no preference is stored)
  - Automatically switches between light/dark based on OS preference when "Auto" is selected
  - User preference is stored in localStorage and persists across sessions

### Components
- **SettingsMenu Component** (`app/components/ui/common/layout/SettingsMenu.tsx`):
  - Added third theme option "Auto" with Monitor icon alongside Light and Dark
  - Updated checkmark logic to show selection based on actual theme value (light/dark/system)
  - Icon display now uses `resolvedTheme` to show correct sun/moon icon based on actual applied theme
  - Added `getThemeIcon()` helper function for dynamic icon display

### Translation Updates
- Added `theme.auto` translation key to all 32 language files
  - English: "Auto"
  - All other languages: "Auto" (universal term, falls back to English where not translated)

### Technical Details
- Uses next-themes built-in system theme detection (`enableSystem` and `defaultTheme="system"`)
- ThemeProvider already configured in layout.tsx with system theme support
- `resolvedTheme` provides the actual applied theme (light/dark) when system mode is active
- localStorage persistence handled automatically by next-themes library

## [2026-01-30] - Move Settings and Donate Buttons to Mobile Menu Header

### Components
- **Header Component** (`app/components/ui/common/layout/header.tsx`):
  - Added Settings and Donate buttons to the top of the mobile menu dialog
  - Buttons now appear in a horizontal row at the top of the mobile navigation, above the Home link
  - Improved mobile UX by making these actions immediately accessible when the menu opens
  - Uses flexbox layout with `justify-end` for right-aligned buttons
  - Responsive: only visible on mobile (`md:hidden`)

### Technical Details
- Added new `<div>` element inside the DialogContent with `flex items-center justify-end gap-2` classes
- SettingsMenu component rendered directly in the mobile header row
- Donate button uses the existing translation key `t("donate")` for consistent text
- Maintains existing click behavior with `onClick={() => setIsOpen(false)}` to close menu after navigation

## [2026-01-30] - Improve RTL Support for Question Categories Accordion

### Components
- **QuestionCategoriesClient.tsx** (`app/components/content/QuestionCategoriesClient.tsx`):
  - Added RTL (Right-to-Left) language support for the accordion layout
  - Arrow indicators now adapt to text direction:
    - LTR languages: Shows `->` arrow with right margin
    - RTL languages: Shows `<-` arrow with left margin
  - Question text padding adjusts based on text direction (pr-2 for LTR, pl-2 for RTL)

### Hooks
- **useIsRtl.ts** (`app/hooks/useIsRtl.ts`): New custom hook to detect RTL languages
  - Detects RTL based on current locale from next-intl
  - Supports Hebrew (he), Arabic (ar), Persian/Farsi (fa), and Urdu (ur)
  - Returns boolean indicating if current locale is RTL

### Technical Details
- RTL detection uses locale from next-intl's `useLocale()` hook
- Dynamic className adjustment using `cn()` utility for conditional margin/padding
- Arrow direction flips based on text direction for better UX in RTL languages

## [2026-01-30] - Implement Right-to-Left (RTL) Language Support

### Features
- **RTL Language Support**: Implemented proper right-to-left text direction for Hebrew (he) and Persian/Farsi (fa) languages
  - HTML `dir` attribute now dynamically set based on locale (`rtl` for RTL languages, `ltr` for all others)
  - HTML `lang` attribute now correctly reflects the current locale instead of hardcoded "en"
  - Layout automatically adjusts for RTL reading direction on StartPage and throughout the application

### Technical Details
- **i18n/locales.ts**: Added RTL detection utilities:
  - `rtlLocales`: Array containing RTL language codes (`["he", "fa"]`)
  - `isRTL(code)`: Function to check if a locale is RTL
  - `getDirection(code)`: Function returning `"rtl" | "ltr"` for a given locale

- **app/layout.tsx**: Updated root layout to support dynamic text direction:
  - Added `extractLocaleFromPath()` function to parse locale from URL pathname
  - HTML element now receives dynamic `lang={locale}` and `dir={dir}` attributes
  - Locale detection works for all 32 supported languages

### Languages Supported
- **Hebrew (he)**: עברית - Right-to-left text direction
- **Persian/Farsi (fa)**: فارسی - Right-to-left text direction

### Implementation Notes
- RTL support is automatic based on URL locale prefix (e.g., `/he/`, `/fa/`)
- No additional CSS or component changes required - browsers handle RTL layout automatically when `dir="rtl"` is set
- All existing LTR languages continue to work with `dir="ltr"` (default)

## [2026-01-30] - Update Translations: Stories & Timelines → Stories & Statistics

### Translation Updates
- **Navigation Labels**: Updated `home.navigation.storiesFull` from "Stories & Timelines" to "Stories & Statistics" in all 32 language files
- **Header Resources**: Updated `header.resources.stories` from "Stories & Timelines" to "Stories & Statistics" in all 32 language files
- **Page Subtitles**: Updated `stories.subtitle` to reference "statistics" instead of "timelines" across all languages

### Languages Updated
- **German** (de): "Geschichten und Zeitlinien" → "Geschichten und Statistiken"
- **Spanish** (es): "Historias y Cronologías" → "Historias y Estadísticas"
- **French** (fr): "Histoires et Chronologies" → "Histoires et Statistiques"
- **Italian** (it): "Storie e Cronologie" → "Storie e Statistiche"
- **Portuguese** (pt): "Histórias e Cronologias" → "Histórias e Estatísticas"
- **Dutch** (nl): "Verhalen & Tijdlijnen" → "Verhalen & Statistieken"
- **Swedish** (sv): "Historier & Tidslinjer" → "Historier & Statistik"
- **Danish** (da): "Historier & Tidslinjer" → "Historier & Statistik"
- **Norwegian** (no): "Historier & Tidslinjer" → "Historier & Statistikk"
- **Finnish** (fi): "Tarinoita ja Aikajat" → "Tarinoita ja Tilastot"
- **Czech** (cz): "Příběhy a Časové osy" → "Příběhy a Statistiky"
- **Polish** (pl): "Historie i Oś czasu" → "Historie i Statystyki"
- **Hungarian** (hu): "Történetek és Idővonalak" → "Történetek és Statisztikák"
- **Romanian** (ro): "Povești și Cronologii" → "Povești și Statistici"
- **Bulgarian** (bg): "Истории и Времеви линии" → "Истории и Статистика"
- **Slovenian** (sl): "Zgodbe in Časovnice" → "Zgodbe in Statistika"
- **Lithuanian** (lt): "Istorijos ir Laiko juostos" → "Istorijos ir Statistika"
- **Russian** (ru): "Истории и Хронологии" → "Истории и Статистика"
- **Ukrainian** (uk): "Історії та Хронології" → "Історії та Статистика"
- **Turkish** (tr): "Hikayeler ve Zaman Çizelgeleri" → "Hikayeler ve İstatistikler"
- **Greek** (el): "Ιστορίες & Χρονοδιαγράμματα" → "Ιστορίες & Στατιστικά"
- **Hebrew** (he): "סיפורים וצירי זמן" → "סיפורים וסטטיסטיקה"
- **Japanese** (ja): "ストーリーとタイムライン" → "ストーリーと統計"
- **Korean** (ko): "이야기와 타임라인" → "이야기와 통계"
- **Chinese Simplified** (zh-cn): "故事与时间线" → "故事与统计数据"
- **Chinese Traditional** (zh-tw): "故事與時間線" → "故事與統計數據"
- **Hindi** (hi): "कहानियाँ और टाइमलाइन" → "कहानियाँ और आंकड़े"
- **Thai** (th): "เรื่องราวและไทม์ไลน์" → "เรื่องราวและสถิติ"
- **Vietnamese** (vi): "Câu chuyện và Dòng thờ gian" → "Câu chuyện và Thống kê"
- **Indonesian** (id): "Cerita & Timeline" → "Cerita & Statistik"
- **Persian/Farsi** (fa): "داستان‌ها و خطوط زمانی" → "داستان‌ها و آمار"
- **English** (en): "Stories & Timelines" → "Stories & Statistics"

### Technical Details
- Updated translation keys across all language files in `messages/*.json`
- Changes affect navigation menu, header dropdown, and page subtitles
- Chart timeline data references remain unchanged (still refer to actual user timeline data)
- Fixed JSON syntax error in Spanish (es.json) - removed extra closing braces

### Code Changes
- **StartPage.tsx** (app/components/content/StartPage.tsx:131): Fixed hardcoded string " & Timelines" → " & Statistics" in the navigation button that was overriding the translation
  - The Stories navigation button had a hardcoded `<span className="hidden sm:inline"> & Timelines</span>` that displayed regardless of the translation file
  - This hardcoded string has been updated to " & Statistics" to match the translation files

## [2026-01-30] - Add Traditional Chinese (zh-tw) Language Support

### Features
- **Traditional Chinese Full Translation Support**:
  - Added complete Traditional Chinese translation file `messages/zh-tw.json` with all UI strings, navigation, forms, and content
  - Translated all 8 question categories: 精選問題 (Featured Questions), 通用術語 (General Terms), 醫學現實 (Medical Reality), 社會與文化 (Society & Culture), 心理學與身份 (Psychology & Identity), 去過渡之旅 (Detransition Journey), 學術與研究偏見 (Academic & Research Bias), 有爭議的觀點 (Controversial Perspectives)
  - All 73 questions translated with appropriate Traditional Chinese gender terminology

### Translation Files Added
- **Traditional Chinese Messages** (`messages/zh-tw.json`): Complete UI translation with all application strings, settings, definitions, and legal content
- **Traditional Chinese Questions** (`messages/zh-tw.json` questions namespace): Complete question translations with 73 questions across 8 categories

### Gender Terminology Notes (Traditional Chinese)
Traditional Chinese translations include comprehensive terminology explanations:
- **"性" (sex)** = 生物性別 (anatomy, chromosomes, reproduction)
- **"性別" (gender)** = 社會性別 (social roles, behaviors, attributes)
- **"性別認同" (gender identity)** = 內心感覺自己是男性、女性或介於兩者之間
- **"跨性別/跨" (transgender/trans)** = 認同與生物性別不同的性別
- **"去過渡" (detransition)** = 停止認同為跨性別者和/或逆轉過渡步驟
- **"停止" (desisting)** = 曾認同為跨性別者（無醫學干預）的人不再認同為跨性別者
- **"性別不安" (gender dysphoria)** = 當性別認同與生物性別不匹配時經歷的痛苦
- **"性別不符合" (gender non-conformity)** = 不遵循性別刻板印象
- **"AFAB/AMAB"** = 出生時指定女性/男性
- **"性別肯定護理" (gender-affirming care)**
- **"性別探索療法" (gender-exploratory therapy)**
- **"TERF"** (保留英文縮寫並附中文解釋)
- **"死名" (deadnaming)** and **"誤性別" (misgendering)**
- **"順性別" (cisgender)**
- **"非二元" (non-binary)**

### Technical Details
- Traditional Chinese locale (zh-tw) added to `i18n/locales.ts` configuration
- Updated `i18n/locales.ts` header comment to include zh-tw.json
- Traditional Chinese is written left-to-right (LTR) - no RTL layout changes needed
- Gender-related medical and psychological terms include Traditional Chinese explanations
- All gender terms properly contextualized for Traditional Chinese speakers (Taiwan, Hong Kong, Macau)
- Translation follows Traditional Chinese grammar and sentence structure
- Added both "zh-cn" (Simplified) and "zh-tw" (Traditional) to language section for language selection
- Character differences from Simplified Chinese: 過/过, 對/对, 學/学, 們/们, etc.

## [2026-01-30] - Add Simplified Chinese (zh-cn) Language Support

### Features
- **Simplified Chinese Full Translation Support**:
  - Added complete Simplified Chinese translation file `messages/zh-cn.json` with all UI strings, navigation, forms, and content
  - Translated all 8 question categories: 精选问题 (Featured Questions), 通用术语 (General Terms), 医学现实 (Medical Reality), 社会与文化 (Society & Culture), 心理学与身份 (Psychology & Identity), 去过渡之旅 (Detransition Journey), 学术与研究偏见 (Academic & Research Bias), 有争议的观点 (Controversial Perspectives)
  - All 73 questions translated with appropriate Chinese gender terminology

### Translation Files Added
- **Simplified Chinese Messages** (`messages/zh-cn.json`): Complete UI translation with all application strings, settings, definitions, and legal content
- **Simplified Chinese Questions** (`messages/zh-cn.json` questions namespace): Complete question translations with 73 questions across 8 categories

### Gender Terminology Notes (Simplified Chinese)
Simplified Chinese translations include comprehensive terminology explanations:
- **"性" (sex)** = 生物性别 (anatomy, chromosomes, reproduction)
- **"性别" (gender)** = 社会性别 (social roles, behaviors, attributes)
- **"性别认同" (gender identity)** = 内心感觉自己是男性、女性或介于两者之间
- **"跨性别/跨" (transgender/trans)** = 认同与生物性别不同的性别
- **"去过渡" (detransition)** = 停止认同为跨性别者和/或逆转过渡步骤
- **"停止" (desisting)** = 曾认同为跨性别者（无医学干预）的人不再认同为跨性别者
- **"性别不安" (gender dysphoria)** = 当性别认同与生物性别不匹配时经历的痛苦
- **"性别不符合" (gender non-conformity)** = 不遵循性别刻板印象
- **"AFAB/AMAB"** = 出生时指定女性/男性
- **"性别肯定护理" (gender-affirming care)**
- **"性别探索疗法" (gender-exploratory therapy)**
- **"TERF"** (保留英文缩写并附中文解释)
- **"死名" (deadnaming)** and **"误性别" (misgendering)**
- **"顺性别" (cisgender)**
- **"非二元" (non-binary)**

### Technical Details
- Simplified Chinese locale (zh-cn) added to `i18n/locales.ts` configuration
- Updated `i18n/locales.ts` header comment to include zh-cn.json
- Chinese is written left-to-right (LTR) - no RTL layout changes needed
- Gender-related medical and psychological terms include Chinese explanations
- All gender terms properly contextualized for Chinese speakers
- Translation follows Chinese grammar and sentence structure
- Added "zh-cn" to language section in translation file for language selection

## [2026-01-30] - Add Lithuanian (lt) Language Support

### Features
- **Lithuanian Full Translation Support**:
  - Added complete Lithuanian translation file `messages/lt.json` with all UI strings, navigation, forms, and content
  - Added Lithuanian question translations in `app/lib/questions.lt.ts`
  - Translated all 8 question categories: Teminiai klausimai (Featured Questions), Bendros sąvokos (General Terms), Medicininė realybė (Medical Reality), Visuomenė ir kultūra (Society & Culture), Psichologija ir tapatybė (Psychology & Identity), Detranzicijos kelionė (Detransition Journey), Akademinis ir tyrimų šališkumas (Academic & Research Bias), Kontroversiškos perspektyvos (Controversial Perspectives)
  - All 73 questions translated with appropriate Lithuanian gender terminology

### Translation Files Added
- **Lithuanian Messages** (`messages/lt.json`): Complete UI translation with all application strings, settings, definitions, and legal content
- **Lithuanian Questions** (`app/lib/questions.lt.ts`): Complete question translations with 73 questions across 8 categories

### Gender Terminology Notes (Lithuanian)
Lithuanian translations include comprehensive terminology explanations in the header comments:
- **"Lytis"** (sex/biological sex) = biologinė lytis (anatomy, chromosomes, reproduction)
  - Note: In Lithuanian, "lytis" primarily refers to biological sex
- **"Giminė"** (gender) = socialinė giminė (social roles, behaviors, attributes that society considers appropriate for men and women based on their biological sex)
  - This distinguishes the social concept from biological "lytis"
- **"Lyties tapatybė"** (gender identity) = vidinis pojūtis būti vyru, moterimi ar kažkur tarp jų
- **"Translytis/trans"** (transgender) = identifikavimasis su gimine, kuri skiriasi nuo žmogaus biologinės lyties
- **"Detranzicija"** (detransition) = nustojimas identifikuoti save kaip translytį ir/arba pereinamojo laikotarpio žingsnių atšaukimas
- **"Pasitraukimas"** (desistance) = kai kas nors, kas identifikavo save kaip translytį (be medicininių intervencijų), nebeidentifikuoja savęs kaip translyčio
- **"Lyties disforija"** (gender dysphoria) = kančia, patiriama kai lyties tapatybė neatitinka biologinės lyties
- **"Lyties normų nesilaikymas"** (gender non-conformity) = kai žmogus elgiasi/pristato save kitaip, nei visuomenė tikisi pagal jo/jos biologinę lytį
- **"AFAB/AMAB"** = gimusi moterimi / gimęs vyru (priskirta moterimi/vyru gimus)
- **"Lytį patvirtinanti priežiūra"** (gender-affirming care)
- **"Lyties tyrinėjimo terapija"** (gender-exploratory therapy)
- **"TERF"** (preserved with Lithuanian explanation)
- **"Mirusio vardo vartojimas"** (deadnaming) and **"Neteisingas lytinis adresavimas"** (misgendering)
- **"Cislytis"** (cisgender)
- **"Nebinarinis"** (non-binary)

### Technical Details
- Lithuanian locale (lt) added to routing configuration in `i18n/routing.ts` and `next-intl.config.ts`
- Lithuanian has grammatical gender (masculine/feminine) but no grammatical cases for gender-neutral terms
- Gender-related medical and psychological terms include Lithuanian explanations in terminology header comments
- All gender terms properly contextualized for Lithuanian speakers
- Translation follows Lithuanian grammar and sentence structure
- Lithuanian is an inflected language with 7 grammatical cases, requiring careful handling of word endings

## [2026-01-30] - Add Persian/Farsi (fa) Language Support

### Features
- **Persian/Farsi Full Translation Support**:
  - Added complete Persian (Farsi) translation file `messages/fa.json` with all UI strings, navigation, forms, and content
  - Added Persian question translations in `app/lib/questions.fa.ts`
  - Translated all 8 question categories: سوالات برجسته (Featured Questions), اصطلاحات عمومی (General Terms), واقعیت پزشکی (Medical Reality), جامعه و فرهنگ (Society & Culture), روانشناسی و هویت (Psychology & Identity), سفر بازگشت از ترنس (Detransition Journey), تعصب آکادمیک و پژوهشی (Academic & Research Bias), دیدگاه‌های بحث‌برانگیز (Controversial Perspectives)
  - All 73 questions translated with appropriate Persian gender terminology

### Translation Files Added
- **Persian Messages** (`messages/fa.json`): Complete UI translation with all application strings, settings, definitions, and legal content
- **Persian Questions** (`app/lib/questions.fa.ts`): Complete question translations with 73 questions across 8 categories

### Gender Terminology Notes (Persian/Farsi)
Persian translations include comprehensive terminology explanations in the header comments:
- **"جنس" (sex)** = جنس بیولوژیکی (anatomy, chromosomes, reproduction)
  - Note: In Persian/Farsi, "جنس" and "جنسیت" are often used interchangeably in everyday speech, but have distinct meanings in this context
- **"جنسیت" (gender)** = جنسیت اجتماعی (social roles, behaviors, attributes)
- **"هویت جنسیتی" (gender identity)** = احساس درونی از مرد یا زن بودن
- **"ترنس/ترنسجندر" (transgender)** = شناسایی با جنسیتی که با جنس بیولوژیکی متفاوت است
- **"بازگشت از ترنس" (detransition)** = قطع شناسایی به عنوان ترنس و/یا معکوس کردن مراحل ترنزیشن
- **"توقف" (desisting)** = زمانی که کسی که به عنوان ترنس شناسایی می‌شد (بدون مداخلات پزشکی) دیگر به عنوان ترنس شناسایی نمی‌شود
- **"دیسفوریا جنسیتی" (gender dysphoria)** = پریشانی تجربه شده زمانی که هویت جنسیتی با جنس بیولوژیکی مطابقت ندارد
- **"عدم تطابق جنسیتی" (gender non-conformity)** = عدم پیروی از کلیشه‌های جنسیتی
- **"AFAB/AMAB"** = زن/مرد تلقی شده هنگام تولد (assigned female/male at birth)
- **"مراقبت تأییدکننده جنسیت" (gender-affirming care)**
- **"درمان اکتشافی جنسیت" (gender-exploratory therapy)**
- **"TERF"** (preserved with Persian explanation)
- **"نام مرده (deadnaming)"** and **"اشتباه جنسیت‌گذاری (misgendering)"** (explained in Persian context)
- **"سیس‌جندر" (cisgender)**
- **"غیردودویی" (non-binary)**

### Technical Details
- Persian locale (fa) added to routing configuration in `i18n/routing.ts`
- Persian is written right-to-left (RTL) - note: RTL layout support may need additional CSS/styling updates
- Persian has no grammatical gender (unlike Arabic or Hebrew) - pronouns are gender-neutral (او / u can mean he or she)
- Gender-related medical and psychological terms include Persian explanations in terminology header comments
- All gender terms properly contextualized for Persian speakers
- Translation follows Persian grammar and sentence structure

## [2026-01-30] - Add Turkish (tr) Language Support

### Features
- **Turkish Full Translation Support**:
  - Added complete Turkish translation file `messages/tr.json` with all UI strings, navigation, forms, and content
  - Added Turkish question translations in `app/lib/questions.tr.ts`
  - Translated all 8 question categories: Öne Çıkan Sorular (Featured Questions), Genel Terimler (General Terms), Tıbbi Gerçek (Medical Reality), Toplum ve Kültür (Society & Culture), Psikoloji ve Kimlik (Psychology & Identity), Detransition Yolculuğu (Detransition Journey), Akademik ve Araştırma Önyargısı (Academic & Research Bias), Tartışmalı Bakış Açıları (Controversial Perspectives)
  - All 73 questions translated with appropriate Turkish gender terminology

### Translation Files Added
- **Turkish Messages** (`messages/tr.json`): Complete UI translation with all application strings, settings, definitions, and legal content
- **Turkish Questions** (`app/lib/questions.tr.ts`): Complete question translations with 73 questions across 8 categories

### Gender Terminology Notes (Turkish)
Turkish translations include comprehensive terminology explanations:
- **"Cinsiyet"** (sex) = biological sex (anatomy, chromosomes, reproduction)
  - Note: In Turkish, "cinsiyet" can mean both sex and gender depending on context
- **"Toplumsal cinsiyet"** (gender) = social gender (social roles, behaviors, attributes)
- **"Cinsiyet kimliği"** (gender identity) = internal sense of being male/female/other
- **"Transgender/trans"** (transgender) = identifying with gender different from biological sex
- **"Detransition"** (detransition) = ceasing to identify as transgender and/or reversing transition steps
- **"Desistance/vazgeçme"** = when someone who identified as trans without medical interventions no longer identifies as trans
- **"Cinsiyet disforisi"** (gender dysphoria) = distress experienced when gender identity doesn't match biological sex
- **"Cinsiyet uyumsuzluğu"** (gender non-conformity) = not conforming to gender stereotypes
- **"AFAB/AMAB"** = doğumda kadın/erkek atandı (assigned female/male at birth)
- **"Cinsiyet onaylayıcı bakım"** (gender-affirming care)
- **"Cinsiyet keşifçi terapi"** (gender-exploratory therapy)
- **"TERF"** (preserved with Turkish explanation)
- **"Ölü isimlendirme (deadnaming)"** and **"Yanlış cinsiyetlendirme (misgendering)"** (explained in Turkish context)
- **"Cisgender"** (cisgender)
- **"Non-binary"** (non-binary)

### Technical Details
- Turkish locale (tr) ready for integration into language selector
- Translation follows Turkish grammar and sentence structure
- Gender-related medical and psychological terms include Turkish explanations in terminology header comments
- All gender terms properly contextualized for Turkish speakers
- Turkish is a gender-neutral language grammatically (no "he/she" distinction), requiring careful contextual handling

## [2026-01-30] - Add Vietnamese (vi) Language Support

### Features
- **Vietnamese Full Translation Support**:
  - Added complete Vietnamese translation file `messages/vi.json` with contact page translations
  - Added Vietnamese question translations in `app/lib/questions.vi.ts`
  - Translated all 8 question categories: Câu hỏi Nổi bật (Featured Questions), Thuật ngữ Chung (General Terms), Thực tế Y tế (Medical Reality), Xã hội & Văn hóa (Society & Culture), Tâm lý & Nhận dạng (Psychology & Identity), Hành trình Hủy bỏ Chuyển giới (Detransition Journey), Thiên kiến Học thuật & Nghiên cứu (Academic & Research Bias), Quan điểm Gây tranh cãi (Controversial Perspectives)
  - All 73 questions translated with appropriate Vietnamese gender terminology

### Translation Files Added
- **Vietnamese Messages** (`messages/vi.json`): Complete contact page translation
- **Vietnamese Questions** (`app/lib/questions.vi.ts`): Complete question translations with 73 questions across 8 categories

### Gender Terminology Notes (Vietnamese)
Vietnamese translations include comprehensive terminology explanations:
- **"Giới tính sinh học"** (sex) = biological sex (anatomy, chromosomes, reproduction)
- **"Giới"** (gender) = social gender (social roles, behaviors, attributes)
- **"Bản dạng giới"** (gender identity) = internal sense of being male/female/other
- **"Chuyển giới/trans"** (transgender) = identifying with gender different from biological sex
- **"Hủy bỏ chuyển giới"** (detransition) = ceasing to identify as transgender and/or reversing transition steps
- **"Từ bỏ"** (desisting) = when someone who identified as trans without medical interventions no longer identifies as trans
- **"Khó chịu về giới"** (gender dysphoria) = distress experienced when gender identity doesn't match biological sex
- **"Không tuân thủ giới (GNC)"** (gender non-conformity) = not conforming to gender stereotypes
- **"AFAB/AMAB"** = được gán giới tính nữ/nam khi sinh (assigned female/male at birth)
- **"Chăm sóc khẳng định giới"** (gender-affirming care)
- **"Liệu pháp khám phá giới"** (gender-exploratory therapy)
- **"TERF"** (preserved with Vietnamese explanation)
- **"Gọi tên cũ (deadnaming)"** and **"Gọi sai giới (misgendering)"** (explained in Vietnamese context)
- **"Ngườithuận giới"** (cisgender)
- **"Không nhị phân"** (non-binary)

### Technical Details
- Vietnamese locale (vi) ready for integration into language selector
- Translation follows Vietnamese grammar and sentence structure
- Gender-related medical and psychological terms include Vietnamese explanations in terminology header comments
- All gender terms properly contextualized for Vietnamese speakers
- Includes notes about Vietnamese cultural context regarding gender concepts

## [2026-01-30] - Add Finnish (fi) Language Support

### Features
- **Finnish Full Translation Support**:
  - Added complete Finnish translation file `messages/fi.json` with all UI strings, navigation, forms, and content
  - Added Finnish question translations in `app/lib/questions.fi.ts`
  - Translated all 8 question categories: Suositellut kysymykset (Featured Questions), Yleiset termit (General Terms), Lääketieteellinen todellisuus (Medical Reality), Yhteiskunta ja kulttuuri (Society & Culture), Psykologia ja identiteetti (Psychology & Identity), Detransition-matka (Detransition Journey), Akateeminen ja tutkimusharha (Academic & Research Bias), Kiistanalaiset näkökulmat (Controversial Perspectives)
  - All 73 questions translated with appropriate Finnish gender terminology

### Translation Files Added
- **Finnish Messages** (`messages/fi.json`): Complete UI translation with all application strings, settings, definitions, and legal content
- **Finnish Questions** (`app/lib/questions.fi.ts`): Complete question translations with 73 questions across 8 categories

### Gender Terminology Notes (Finnish)
Finnish translations include comprehensive terminology explanations:
- **"Sukupuoli (biologinen)"** (sex) = biological sex (anatomy, chromosomes, reproduction)
- **"Gender (sosiaalinen sukupuoli)"** (gender) = social gender (social roles, behaviors, attributes)
- **"Sukupuoli-identiteetti"** (gender identity) = internal sense of being male/female/other
- **"Transsukupuolinen / trans"** (transgender) = identifying with gender different from biological sex
- **"Detransitio"** (detransition) = ceasing to identify as transgender and/or reversing transition steps
- **"Luopuminen (desistance)"** = when someone who identified as trans without medical interventions no longer identifies as trans
- **"Sukupuolidysforia"** (gender dysphoria) = distress experienced when gender identity doesn't match biological sex
- **"Sukupuoleen sopimattomuus / sukupuolinormien vastaisuus"** (gender non-conformity) = not conforming to gender stereotypes
- **"AFAB/AMAB"** = syntyessä määritelty naiseksi/mieheksi (assigned female/male at birth) - Finnish abbreviations: SMN/SMM
- **"Sukupuoliaffirmoiva hoito"** (gender-affirming care)
- **"Sukupuolen tutkiva terapia"** (gender-exploratory therapy)
- **"TERF"** (preserved with Finnish explanation)
- **"Deadnaming"** and **"Misgendering"** (preserved with Finnish explanations)
- **"Cis-sukupuolinen"** (cisgender)
- **"Ei-binäärinen"** (non-binary)

### Technical Details
- Finnish locale (fi) added to routing configuration in `i18n/routing.ts`
- Finnish language support added to QuestionCategories components
- Translation follows Finnish grammar and sentence structure
- Finnish uses "sukupuoli" for both biological sex and social gender, requiring careful contextual distinction
- Gender-related medical and psychological terms include Finnish explanations in terminology header comments
- All gender terms properly contextualized for Finnish speakers

## [2026-01-30] - Add Greek (el) Language Support

### Features
- **Greek Full Translation Support**:
  - Added complete Greek translation file `messages/el.json` with all UI strings, navigation, forms, and content
  - Added Greek question translations in `app/lib/questions.el.ts`
  - Translated all 8 question categories: Επιλεγμένες Ερωτήσεις (Featured Questions), Γενικοί Όροι (General Terms), Η Ιατρική Πραγματικότητα (Medical Reality), Κοινωνία & Πολιτισμός (Society & Culture), Ψυχολογία & Ταυτότητα (Psychology & Identity), Το Ταξίδι της Αποχώρησης (Detransition Journey), Ακαδημαϊκή & Ερευνητική Προκατάληψη (Academic & Research Bias), Αμφιλεγόμενες Προοπτικές (Controversial Perspectives)
  - All 73 questions translated with appropriate Greek gender terminology

### Translation Files Added
- **Greek Messages** (`messages/el.json`): Complete UI translation with all application strings, settings, definitions, and legal content
- **Greek Questions** (`app/lib/questions.el.ts`): Complete question translations with 73 questions across 8 categories

### Gender Terminology Notes (Greek)
Greek translations include comprehensive terminology explanations:
- **"Βιολογικό φύλο"** (sex) = biological sex (anatomy, chromosomes, reproduction)
- **"Κοινωνικό φύλο"** (gender) = social gender (social roles, behaviors, attributes)
- **"Ταυτότητα φύλου"** (gender identity) = internal sense of being male/female/other
- **"Τρανς/τρανσενεργός"** (transgender) = identifying with gender different from birth sex
- **"Αποχώρηση από τη μετάβαση"** (detransition) = ceasing to identify as transgender
- **"Αποχώρηση από την ταύτιση"** (desisting) = stopping trans identification without medical steps
- **"Δυσφορία φύλου"** (gender dysphoria) = distress from gender/sex mismatch
- **"Μη συμμόρφωση με το φύλο"** (gender non-conformity) = not conforming to gender stereotypes
- **"ΑΦΑΒ/ΑΜΑΒ"** (AFAB/AMAB) = Ανατεθέν Θηλυκό/Αρσενικό κατά τη Γέννηση (Assigned Female/Male at Birth - explained in context)
- **"Φροντίδα επιβεβαίωσης φύλου"** (gender-affirming care)
- **"Εξερευνητική θεραπεία φύλου"** (gender-exploratory therapy)
- **"TERF"** (preserved with Greek explanation)
- **"Αλλαγή ονόματος από νεκρό"** (deadnaming) and **"Λάθος αναφορά φύλου"** (misgendering)
- **"Cisgender"** (cisgender)
- **"Μη δυαδικό"** (non-binary)

### Technical Details
- Greek locale (el) added to language selection
- Translation follows Greek grammar and sentence structure
- Greek is a highly gendered language requiring careful grammatical adaptation based on the gender of the person being referred to
- Gender-related medical and psychological terms include Greek explanations in terminology header comments
- All gender terms properly contextualized for Greek speakers

## [2026-01-30] - Add Hungarian (hu) Language Support

### Features
- **Hungarian Full Translation Support**:
  - Added complete Hungarian translation file `messages/hu.json` with all UI strings, navigation, forms, and content
  - Added Hungarian question translations in `app/lib/questions.hu.ts`
  - Translated all 8 question categories: Kiemelt kérdések (Featured Questions), Általános fogalmak (General Terms), Az orvosi valóság (Medical Reality), Társadalom és kultúra (Society & Culture), Pszichológia és identitás (Psychology & Identity), A detransition útja (Detransition Journey), Akadémiai és kutatási elfogultság (Academic & Research Bias), Vitás perspektívák (Controversial Perspectives)
  - All 73 questions translated with appropriate Hungarian gender terminology

### Translation Files Added
- **Hungarian Messages** (`messages/hu.json`): Complete UI translation with all application strings, settings, definitions, and legal content
- **Hungarian Questions** (`app/lib/questions.hu.ts`): Complete question translations with 73 questions across 8 categories

### Gender Terminology Notes (Hungarian)
Hungarian translations include comprehensive terminology explanations:
- **"Nem"** (biological sex) = biológiai nem (anatomy, chromosomes, reproduction)
- **"Gender"** (social gender) = társadalmi nem (social roles, behaviors, attributes)
- **"Nemi identitás"** (gender identity) = internal sense of being male/female/other
- **"Transznemű/trans"** (transgender) = identifying with gender different from birth sex
- **"Detransition/visszaátmenet"** = ceasing to identify as transgender
- **"Leállás (desistance)"** = stopping trans identification without medical steps
- **"Nemi diszfória"** (gender dysphoria) = distress from gender/sex mismatch
- **"Nemi nem-konformitás"** (gender non-conformity) = not conforming to gender stereotypes
- **"AFAB/AMAB"** = születési nőként/férfiként meghatározva (explained in context)
- **"Nemi azonosságot megerősítő ellátás"** (gender-affirming care)
- **"Nemi felfedező terápia"** (gender-exploratory therapy)
- **"TERF"** (preserved with Hungarian explanation)
- **"Deadnaming"** and **"Misgendering"** (explained in Hungarian context)
- **"Cisznemű"** (cisgender)
- **"Nem-bináris"** (non-binary)

### Technical Details
- Hungarian locale (hu) added to language selection in SettingsMenu component
- Translation follows Hungarian grammar and sentence structure
- Gender-related medical and psychological terms include Hungarian explanations in terminology header comments
- All gender terms properly contextualized for Hungarian speakers

## [2026-01-30] - Add Italian (it) Question Translations

### Features
- **Italian Question Translations**:
  - Added Italian translations for all question categories in `app/lib/questions.it.ts`
  - Translated all 8 question categories: Domande in Evidenza (Featured Questions), Termini Generali (General Terms), La Realtà Medica (Medical Reality), Società e Cultura (Society & Culture), Psicologia e Identità (Psychology & Identity), Il Viaggio della Detransizione (Detransition Journey), Bias Accademico e di Ricerca (Academic & Research Bias), Prospettive Controverse (Controversial Perspectives)
  - 52 questions translated with appropriate gender terminology explanations

### Translation Files Added
- **Italian Questions** (`app/lib/questions.it.ts`): Complete question translations with 52 questions across 8 categories

### Technical Details
- Italian locale (it) already configured in SettingsMenu component
- All gender-related medical and psychological terms include Italian explanations where necessary
- Gender terminology translations include:
  - detrans/detransitioner (detrans/persona detrans)
  - trans/transgender (trans/persona trans)
  - gender-affirming care (cura di affermazione di genere)
  - gender-exploratory therapy (terapia esplorativa di genere)
  - gender dysphoria (disforia di genere)
  - desisting (desistere)
  - non-binary (non-binario/non-binaria)
  - queer (queer)
  - AFAB/AMAB (AFAB/AMAB - explained in context)
  - TERF (TERF - technical term preserved with explanation)
  - deadnaming (deadnaming - explained in context)
  - misgendering (misgendering - explained in context)
  - autogynephilia (autoginefilia - explained in context)
  - passing (passing - explained in context)

## [2026-01-30] - Add Russian (ru) Question Translations

### Features
- **Russian Question Translations**:
  - Added Russian translations for all question categories in `app/lib/questions.ru.ts`
  - Translated all 8 question categories: Основные вопросы (Featured Questions), Общие термины (General Terms), Медицинская реальность (Medical Reality), Общество и культура (Society & Culture), Психология и идентичность (Psychology & Identity), Путь детрансишн (Detransition Journey), Академический и исследовательский предвзятость (Academic & Research Bias), Спорные перспективы (Controversial Perspectives)
  - 52 questions translated with appropriate gender terminology explanations

### Translation Files Added
- **Russian Questions** (`app/lib/questions.ru.ts`): Complete question translations with 52 questions across 8 categories

### Technical Details
- Russian locale (ru) already configured in SettingsMenu component
- All gender-related medical and psychological terms include Russian explanations where necessary
- Gender terminology translations include:
  - детранс* (detrans/detransitioner) - gender-inclusive term
  - транс* (trans/transgender) - gender-inclusive term
  - гендерно-подтверждающий уход (gender-affirming care)
  - гендерно-исследовательская терапия (gender-exploratory therapy)
  - гендерная дисфория (gender dysphoria)
  - десистенция (desisting)
  - небинарный (non-binary)
  - квир (queer)

## [2026-01-30] - Add Japanese (ja) Translation File and Questions

### Features
- **Japanese Translation File**:
  - Added complete Japanese translation for all UI text in `messages/ja.json`
  - Translated all namespaces: metadata, home, header, language, settings, theme, definitions, chat, chatInput, deepResearchEvents, questionTabs, conversations, conversationCard, stories, prompts, donatePage, terms, videos, videoList, videoSubmitForm, studySubmitForm, studiesPage, contentWarning, supportPage, charts, contact, seo
  - Gender-related terms properly translated with cultural context:
    - ジェンダー (gender) vs 性別 (sex/biological sex)
    - トランスジェンダー (transgender)
    - デトランジション (detransition) / デトランジショナー (detransitioner)
    - ジェンダー違和 (gender dysphoria)
    - ジェンダーアファーミングケア (gender-affirming care)
    - ジェンダー探索療法 (gender-exploratory therapy)
    - デシスタンス (desisting)
    - ノンバイナリー (non-binary)
    - クィア (queer)

- **Japanese Question Translations**:
  - Added Japanese translations for all question categories in `app/lib/questions.ja.ts`
  - Translated all 8 question categories: 注目の質問 (Featured Questions), 一般的な用語 (General Terms), 医療の現実 (Medical Reality), 社会と文化 (Society & Culture), 心理学とアイデンティティ (Psychology & Identity), デトランジションの旅 (Detransition Journey), 学術および研究のバイアス (Academic & Research Bias), 物議を醸す視点 (Controversial Perspectives)
  - 52 questions translated with appropriate gender terminology explanations

### Translation Files Added
- **Japanese** (`messages/ja.json`): Complete UI translation with all gender-related terms
- **Japanese Questions** (`app/lib/questions.ja.ts`): Complete question translations with 52 questions across 8 categories

### Technical Details
- Japanese locale (ja) already configured in SettingsMenu component
- All gender-related medical and psychological terms include Japanese explanations in parentheses
- Cultural context preserved for Japanese audience while maintaining clinical accuracy

## [2026-01-30] - Add Chinese (zh-tw and zh-cn) Question Translations

### Features
- **Chinese Question Translations**:
  - Added Traditional Chinese (zh-tw) translations for all question categories in `app/lib/questions.zh-tw.ts`
  - Added Simplified Chinese (zh-cn) translations for all question categories in `app/lib/questions.zh-cn.ts`
  - Translated all 8 question categories: Featured Questions, General Terms, Medical Reality, Society & Culture, Psychology & Identity, Detransition Journey, Academic & Research Bias, and Controversial Perspectives
  - 52 questions translated for each Chinese locale

### Components
- **QuestionCategories Component** (`app/components/content/QuestionCategories.tsx`):
  - Added imports for Chinese translation files (questions.zh-tw and questions.zh-cn)
  - Updated locale selection logic to support zh-tw and zh-cn locales

- **QuestionCategoriesClient Component** (`app/components/content/QuestionCategoriesClient.tsx`):
  - Added imports for Chinese translation files (questions.zh-tw and questions.zh-cn)
  - Updated locale selection logic to support zh-tw and zh-cn locales

### Translation Files Added
- **Traditional Chinese** (`app/lib/questions.zh-tw.ts`): Complete translation with 52 questions across 8 categories
- **Simplified Chinese** (`app/lib/questions.zh-cn.ts`): Complete translation with 52 questions across 8 categories

## [2026-01-29] - Simplify LLM Caching to Store Full Response Objects

### API Changes
- **LLM Caching System** (`app/api/shared/llm.ts`):
  - Simplified caching logic to always store complete response objects instead of made-up text-only objects
  - Removed backward compatibility code for old cache formats
  - Consolidated metadata preparation into a single `prepareMetadata` helper method
  - Fixed TypeScript type handling for `MessageContent` (can be string or array)

### Features
- **Full Response Caching**: Both streaming and non-streaming responses now cache the complete `ChatResponse` or `CompletionResponse` objects
- **Proper Metadata Handling**: Generation metadata from OpenRouter API is properly fetched and stored with cached responses
- **Tool Call Support**: Tool calls in streaming responses are properly captured and replayed from cache
- **Simplified Code**: Reduced code complexity by removing fallback paths and duplicate logic

### Technical Details
- Streaming responses capture all chunks and build a complete response object for caching
- When replaying from cache, the full response structure is preserved (not just text)
- Metadata includes generation costs, token counts, model information, and conversation context
- Rate limiting is checked before making API calls for completion endpoints

### Migration Notes
- Existing cache entries in old format will be automatically handled (parsed as text-only)
- New cache entries will store the full response structure for better fidelity
- No database schema changes required

## [2026-01-30] - SEO Improvements: Sitemap hreflang and Metadata Audit

### SEO Enhancements
- **Sitemap.xml** (`app/sitemap.xml/route.ts`):
  - Added hreflang support to advertise language alternatives to search engines
  - Each base route now includes `xhtml:link` elements for all supported locales (en, es, fr)
  - Added `x-default` hreflang pointing to the English version
  - Uses proper locale codes (en-US, es-ES, fr-FR) for hreflang attributes
  - Dynamic routes (research, stories, videos, chat) remain non-localized in sitemap as they don't have locale-specific content

### Metadata Audit Results

#### Pages WITH Translated Metadata (✓):
1. **Home Page** (`app/[locale]/page.tsx`) - Uses `metadata` namespace
2. **Contact Page** (`app/[locale]/contact/page.tsx`) - Uses `contact.metadata` namespace  
3. **Stories Page** (`app/[locale]/stories/page.tsx`) - Uses `stories.metadata` namespace
4. **Videos Page** (`app/[locale]/videos/page.tsx`) - Uses `videos.metadata` namespace
5. **Definitions Page** (`app/[locale]/definitions/page.tsx`) - Uses `definitions.metadata` namespace
6. **Studies Page** (`app/[locale]/studies/page.tsx`) - Uses `studiesPage.metadata` namespace
7. **Support Page** (`app/[locale]/support/page.tsx`) - Uses `supportPage.metadata` namespace
8. **Participate Page** (`app/[locale]/participate/page.tsx`) - Has metadata but NOT translated (static English only)

#### Pages MISSING Metadata Exports (✗):
1. **About Page** (`app/[locale]/about/page.tsx`) - No metadata export
2. **Donate Page** (`app/[locale]/donate/page.tsx`) - No metadata export
3. **Terms Page** (`app/[locale]/terms/page.tsx`) - No metadata export
4. **Prompts Page** (`app/[locale]/prompts/page.tsx`) - No metadata export
5. **Conversations Page** (`app/[locale]/conversations/page.tsx`) - No metadata export
6. **Login Page** (`app/[locale]/login/page.tsx`) - No metadata export

#### Dynamic Routes Status:
- **Research Question Pages** (`app/[locale]/research/[question]/page.tsx`) - Uses dynamic metadata from question
- **User Story Pages** (`app/[locale]/stories/[username]/page.tsx`) - Uses localized user experience summary
- **Video Detail Pages** (`app/[locale]/videos/[slug]/page.tsx`) - Uses localized video title and description
- **Chat Conversation Pages** (`app/[locale]/chat/[uuid]/page.tsx`) - Uses conversation title/summary metadata

### Translation Files Verified
All three translation files have complete metadata sections:
- **English (en.json)**: Complete metadata translations for all pages
- **Spanish (es.json)**: Complete metadata translations for all pages
- **French (fr.json)**: Complete metadata translations for all pages

### Technical Details
- Sitemap now includes `xmlns:xhtml` namespace for hreflang support
- Base routes are automatically localized to all supported locales
- Hreflang links use standard locale codes (e.g., `hreflang="en-US"`)
- Dynamic content routes don't have locale-specific variations in the sitemap

### Next Steps (Not Implemented)
To complete SEO metadata coverage, the following pages need metadata exports added:
1. Add `generateMetadata()` to About page with translations
2. Add `generateMetadata()` to Donate page with translations
3. Add `generateMetadata()` to Terms page with translations
4. Add `generateMetadata()` to Prompts page with translations
5. Add `generateMetadata()` to Conversations page with translations
6. Add `generateMetadata()` to Login page (optional, may want to hide from SEO)

## [2026-01-30] - Add Settings Menu with Combined Language and Theme Controls

### Components
- **SettingsMenu Component** (`app/components/ui/common/layout/SettingsMenu.tsx`):
  - Replaces separate LanguageSwitcher and ThemeSwitcher components
  - Uses NavigationMenu for hover-expandable dropdown (consistent with other nav elements)
  - Button displays both sun and moon icons + current locale code
  - Single dropdown menu with Language and Appearance sections
  - Shows checkmarks for current selections
  - Integrates with next-themes for theme switching
  - Prevents hydration mismatch with mounted state check

- **Header Component** (`app/components/ui/common/layout/header.tsx`):
  - Replaced separate LanguageSwitcher and ThemeSwitcher with unified SettingsMenu
  - Desktop: SettingsMenu appears as NavigationMenu item that expands on hover
  - Mobile: Single "Settings" section with SettingsMenu dropdown
  - Removed DarkModeToggle component (now integrated into SettingsMenu)
  - Removed unused imports (useTheme, Switch, useEffect)

### Removed Components
- **LanguageSwitcher** (`app/components/ui/common/layout/LanguageSwitcher.tsx`) - Functionality merged into SettingsMenu
- **ThemeSwitcher** (`app/components/ui/common/layout/ThemeSwitcher.tsx`) - Functionality merged into SettingsMenu

### Features
- **Unified Settings**: Single button/icon shows both language code and theme icons
- **Hover-Expandable Menu**: Desktop menu expands on hover like other NavigationMenu items
- **Two-Section Dropdown**: Language section (EN/ES/FR) and Appearance section (Light/Dark)
- **Visual Feedback**: Checkmarks indicate current language and theme selections
- **Mobile Friendly**: Same SettingsMenu component works in mobile view
- **Persistent Preference**: Selected theme is saved and persists across sessions

### Translation Keys Added
- `settings.title` - "Settings" / "Configuración" / "Paramètres"
- `theme.title` - "Appearance" / "Apariencia" / "Apparence"
- `theme.light` - "Light" / "Claro" / "Clair"
- `theme.dark` - "Dark" / "Oscuro" / "Sombre"

### Translations
- **English (en.json)**: Added settings and theme namespaces
- **Spanish (es.json)**: Added Spanish translations for settings and theme
- **French (fr.json)**: Added French translations for settings and theme

### Technical Details
- Uses NavigationMenu component for consistent hover behavior with other nav items
- ThemeProvider already configured in layout.tsx with `attribute="class"`
- Dark mode CSS variables defined in globals.css
- Maintains SEO hreflang meta links in document head

## [2026-01-29] - Add French and Spanish Translations for Contact Page

### Features
- **Contact Page Internationalization**:
  - Added complete French translation for contact form (`messages/fr.json`)
  - Added complete Spanish translation for contact form (`messages/es.json`)
  - Added English translation keys (`messages/en.json`)
  - Translations include: form labels, placeholders, button text, status messages, and metadata

### Components
- **Contact Page** (`app/[locale]/contact/page.tsx`):
  - Refactored to support server-side metadata generation with `generateMetadata()`
  - Split into server component (page.tsx) and client component (ContactForm.tsx)
  - Added SEO metadata with OpenGraph tags for all supported languages

- **ContactForm Component** (`app/[locale]/contact/ContactForm.tsx`):
  - New client component extracted from page.tsx
  - Integrated with `next-intl` useTranslations hook
  - All UI text now uses translation keys instead of hardcoded strings

### Translation Keys Added
- `contact.metadata.title` - Page title
- `contact.metadata.description` - Meta description
- `contact.title` - Form heading
- `contact.intro` - Introductory paragraph
- `contact.form.to` - "To" label
- `contact.form.name` - Name label
- `contact.form.namePlaceholder` - Name input placeholder
- `contact.form.email` - Email label
- `contact.form.emailPlaceholder` - Email input placeholder
- `contact.form.subject` - Subject label
- `contact.form.subjectPlaceholder` - Subject input placeholder
- `contact.form.message` - Message label
- `contact.form.messagePlaceholder` - Message textarea placeholder
- `contact.form.sendButton` - Submit button text
- `contact.form.sending` - Sending status message
- `contact.form.success` - Success message
- `contact.form.error` - Error message

## [2026-01-29] - Fix Database Schema Error by Removing full_question Column

### Database Schema Changes
- **Detrans Questions Table** (`db/schema.ts`):
  - Removed `full_question` column that was causing "column does not exist" errors
  - Changed `name` column from `varchar(255)` to `text` type
  - Updated Zod schema (`questionSchema`) to remove `fullQuestion` field
  - Database migration applied via `db:push` command

### Bug Fixes
- **Cache Library** (`app/lib/cache.ts`):
  - Removed `fullQuestion` field from insert statements in `setCachedAnswer()` and `incrementQuestionViews()`
  - Fixed error: "column 'full_question' of relation 'detrans_questions' does not exist"

- **Research API** (`app/api/research/route.ts`):
  - Removed `fullQuestion` field from database insert operation

### Technical Details
- **Root Cause**: Database schema didn't have `full_question` column but code was trying to insert it
- **Fix**: Removed column from schema and all code references
- **Migration**: Database schema updated via `npm run db:push`
- **Type Safety**: All TypeScript types updated to reflect schema changes

## [2026-01-29] - Fix Suggested Questions Not Appearing in Deep Research Stream

### Bug Fixes
- **Research API** (`app/api/research/route.ts`):
  - Fixed `data-suggested_questions` events not appearing in stream
  - Moved suggested questions generation from `onComplete` to `onFinal` callback
  - Matches pattern used in chat API for consistent behavior
  - Suggested questions now properly appended to stream after conversation is saved

### Technical Details
- **Root Cause**: `createUIMessageStream` from `ai` library requires certain event types to be written in `onFinal` callback rather than `onComplete`
- **Fix**: Moved `sendSuggestedQuestionsEvent()` call from `onComplete` to `onFinal` callback
- **Behavior**: Suggested questions now appear at end of stream after conversation is saved to database
- **Consistency**: Research API now matches chat API pattern for suggested questions delivery

## [2026-01-29] - Deep Research Cache Lookup Fix

### Bug Fixes
- **Cache Library** (`app/lib/cache.ts`):
  - Fixed cache lookup to use correct search strategy
  - First tries exact match on `questionName` column (truncated to 100 chars)
  - Falls back to ILIKE search on `promptText` if exact match not found
  - The cache key is a hash of messages+tools, not the question name, so we search by content

### Technical Details
- Cache entries are stored with:
  - `questionName`: truncated question (100 chars) for identification
  - `promptText`: full JSON key containing messages array
  - `resultText`: the cached response (may be JSON with tool calls)
- Lookup tries exact match first, then flexible text search
- This handles both exact matches and slight variations in question formatting

## [2026-01-29] - Deep Research Loading Fix

### Bug Fixes
- **Chat Section Component** (`app/components/ui/chat/chat-section.tsx`):
  - Fixed `loading` state being stuck at `true` for new deep research sessions
  - Now properly sets `loading` to `false` when no `conversationId` is provided
  - Added `apiEndpoint` prop to support different API endpoints (`/api/chat` vs `/api/deep_research`)

- **Deep Research Section Client** (`app/[locale]/deep-research/DeepResearchSectionClient.tsx`):
  - Now passes `apiEndpoint="/api/deep_research"` to use correct API endpoint

- **Deep Research Index Page** (`app/[locale]/deep-research/page.tsx`):
  - Fixed redirect from `/chat` to proper deep-research routing
  - Now shows placeholder UI when no question is specified
  - Handles `starter` query parameter to redirect to specific questions

### Technical Details
- The loading spinner was shown indefinitely because `loading` was only set to `false` when loading an existing conversation
- Deep research creates new conversations, so the loading state never cleared
- API endpoint mismatch was causing the chat to call `/api/chat` instead of `/api/deep_research`

## [2026-01-29] - Custom Chat Input Deep Research Support

### Component Changes
- **Custom Chat Input** (`app/components/ui/custom-chat-input.tsx`):
  - Added `/deep-research` to `showChatInput` paths so input appears on deep research pages
  - Updated `handleSubmit` to navigate to `/deep-research/${slugify(val)}` when on deep-research pages
  - Modified `showDeepResearch` logic to hide toggle on deep-research pages (already in deep research mode)
  - Deep research now behaves like research mode: navigates to new URL for each question

### Behavior
- **Deep Research Navigation**: Users on `/deep-research/*` pages automatically navigate to new URLs when submitting questions
- **Consistent UX**: Deep research follows same pattern as regular research mode
- **No Toggle on Deep Research Pages**: Toggle button hidden when already on deep-research routes

## [2026-01-29] - Deep Research URL-Based Caching

### Database Schema Changes
- **Detrans Chat Cache Table** (`db/schema.ts`):
  - Added `deep_research` boolean column to distinguish deep research cache entries
  - Added index on `deep_research` column for efficient queries
  - Updated Zod schema to include new field

### API Changes
- **Cache Library** (`app/lib/cache.ts`):
  - Added `getDeepResearchAnswer()` function to fetch cached answers by question name
  - Queries `detrans_chat_cache` table filtering by `question_name` and `deep_research=true`
  - Returns most recent cached result for the given question

### Page Changes
- **Deep Research Page** (`app/[locale]/deep_research/[question]/page.tsx`):
  - Updated to use question slug from URL (e.g., `/deep-research/why-is-the-sky-blue`)
  - Uses `deslugify()` to convert URL slug to readable question text
  - Fetches cached answers using `getDeepResearchAnswer()` instead of UUID-based lookup
  - SEO-optimized with `generateMetadata()` for bot-friendly rendering
  - Passes starter question to `ChatSectionClient` for new research sessions

### Features
- **URL-Based Research**: Users can access research via clean URLs with question slugs
- **Cached Responses**: Same question always returns cached result if available
- **SEO Optimized**: Bots receive server-rendered cached answers for better indexing
- **Question-Based Lookup**: No UUID required - lookup by question name instead

### Migration Notes
- Run database migration to add `deep_research` column: `npm run migrate`
- Existing cached entries will have `deep_research=false` by default

## [2026-01-29] - Implement Deep Research Endpoint

### API Changes
- **Deep Research API** (`app/api/deep_research/route.ts`):
  - Enforced single-message-only behavior (non-conversational)
  - Rejects subsequent messages to existing conversations with 410 status
  - Automatically archives conversations after first response
  - Sets mode to "deep_research" when saving conversations
  - Removed chat history - only processes current user message

- **Deep Research Workflow** (`app/api/deep_research/app/workflow.ts`):
  - Updated cache mode from "detrans_chat" to "deep_research"
  - Updated LLM mode to "deep_research" for proper caching

### Prompt Changes
- **Deep Research Prompt** (`app/api/deep_research/utils/prompts.ts`):
  - Created new `deepResearchPrompt` with comprehensive research focus
  - Emphasizes thorough research with multiple queries (5-7)
  - Includes structured response format: Overview, Key Themes, Personal Experiences, Videos, Conclusion
  - Mandatory research process requiring tool usage
  - Citation requirements for all referenced experiences

### Features
- **Single-Use Sessions**: Deep research conversations are single-use - once a response is generated, the session is archived
- **Comprehensive Research**: Designed to conduct thorough research with multiple query angles
- **Structured Output**: Responses follow a consistent structured format for better readability
- **Same Caching**: Uses the same Postgres caching mechanism as chat endpoint

### Differences from Chat Endpoint
- No conversation history maintained
- Single request/response per session
- More comprehensive research prompt
- Automatic archiving after completion
- Different database mode tracking

## [2026-01-29] - Add Translations for TransitionPathwaysChart Labels

### Components
- **TransitionPathwaysChart** (`app/components/charts/TransitionPathwaysChart.tsx`):
  - Added `translateNodeLabel()` helper function to translate node labels
  - Modified `transformDataForRecharts()` to use translated labels instead of raw English labels
  - Node labels (Male/Female, Before/After 18, Puberty Blockers, etc.) now display in user's locale

### Features
- **French Translations** (`messages/fr.json`):
  - Added `charts.pathways.labels` namespace with 16 label translations
  - Translations for: sex (Male/Female/Unknown), age (Before/After 18), medical interventions (blockers, hormones, surgeries), and outcomes (regrets)

- **Spanish Translations** (`messages/es.json`):
  - Added `charts.pathways.labels` namespace with 16 label translations
  - Translations for: sex (Male/Female/Unknown), age (Before/After 18), medical interventions (blockers, hormones, surgeries), and outcomes (regrets)

### Technical Details
- Uses `next-intl` translation keys with dot notation (e.g., `charts.pathways.labels.Male`)
- Falls back to original English label if translation not found
- All Sankey diagram node labels are now translatable

## [2026-01-29] - Fix TypeScript Null Errors in Video Page

### Bug Fixes
- Fixed TypeScript errors where `string | null` was not assignable to `string | number | Date`
- Added null coalescing operator (`?? ""`) to `localizedTitle` when passed to translation functions
- Fixed iframe `title` attribute to handle null values properly

### Technical Details
- Updated `metadataWatchDescription` calls to use `localizedTitle ?? ""`
- Updated `metadataThumbnailAlt` call to use `localizedTitle ?? ""`
- Updated iframe `title` prop to use `localizedTitle ?? ""`

## [2026-01-29] - Update Studies Page to Load from API

### API Changes
- **Studies API** (`/api/studies/route.ts`):
  - Already supports `locale` query parameter for fetching localized studies
  - Returns translated fields: `headline`, `title`, `description`, and `journal`
  - Falls back to default English if translation not available

### Component Updates
- **Studies Page** (`app/[locale]/studies/page.tsx`):
  - Removed hardcoded `studies` array (39 studies migrated to database)
  - Added `fetchStudies()` function for server-side data fetching
  - Uses Next.js `fetch()` with ISR caching (300 second revalidate)
  - Maintains full server-side rendering for SEO optimization
  - Passes locale from URL params to API for localized content
  - Studies now render with proper `id` keys for React reconciliation

### Features
- **Server-Side Rendering**: Page remains fully server-rendered for optimal SEO
- **Incremental Static Regeneration**: ISR caching ensures fast loads while allowing content updates
- **Locale-Aware Content**: Studies display in user's preferred language
- **Database-Driven**: All study content now served from PostgreSQL database

### Technical Details
- Uses `process.env.NEXT_PUBLIC_APP_URL` for API base URL
- Implements `next.revalidate: 300` for 5-minute ISR cache
- Adds `tags: ["studies"]` for cache invalidation support
- Graceful error handling returns empty array on fetch failure

## [2026-01-29] - Add Video Title Translation Support

### Database Schema Changes
- **Videos Table**: Added `title_translation` column
  - JSON object storing translations for video titles
  - Updated Zod schema (`videoSchema`) to include new `titleTranslation` field
  - Updated migration file: `drizzle/0003_add_video_translation_columns.sql`

### API Changes
- **Videos API** (`/api/videos/route.ts`):
  - Added `titleTranslation` to VideoWithTranslations interface
  - API now returns localized title based on requested locale

### Component Updates
- **VideoList Component** (`app/components/VideoList.tsx`):
  - Added `titleTranslation` to Video interface
  - Video titles are now displayed in the user's locale

- **SeoVideosList Component** (`app/components/SeoVideosList.tsx`):
  - Added `titleTranslation` to Video interface
  - Added title to getLocalizedField mapping
  - SEO-optimized video listings now display translated titles

- **Video Detail Page** (`app/[locale]/videos/[slug]/page.tsx`):
  - Added `titleTranslation` to VideoWithTranslations interface
  - Updated `generateMetadata` to use localized title in page title, description, OpenGraph, and Twitter cards
  - Updated page component to display localized title in h1 heading and iframe title attribute
  - All metadata and visible text now uses the translated title based on user's locale

### Scripts
- **Generate Video Translations** (`scripts/generate-video-translations.ts`):
  - Added title translation generation
  - Script now generates translations for: title, description, summary, and bite
  - Updated VideoWithTranslations interface
  - Updated database update logic to save title translations

### Migration Notes
- Run migration: `npx drizzle-kit migrate`
- Generate translations: `npx tsx scripts/generate-video-translations.ts`

## [2026-01-29] - Add Video Translation Columns Migration

### Database Schema Changes
- **Videos Table**: Created migration to add missing translation columns:
  - `description_translation` - JSON object with description translations
  - `summary_translation` - JSON object with summary translations  
  - `bite_translation` - JSON object with bite/tagline translations
- Migration file: `drizzle/0003_add_video_translation_columns.sql`
- Uses `IF NOT EXISTS` to safely add columns without errors if they already exist

### Migration Notes
- Run migration: `npm run migrate` or `npx drizzle-kit migrate`
- After migration, generate translations: `npx tsx scripts/generate-video-translations.ts`

## [2026-01-29] - Add Videos Page Translations for French and Spanish

### Translation Additions
- **French (fr.json)**:
  - Added complete `videos` namespace with metadata, title, description, and UI strings
  - Added `videoList` namespace with loading states and filter options
  - Added `videoSubmitForm` namespace with form labels and submission messages

- **Spanish (es.json)**:
  - Added complete `videos` namespace with metadata, title, description, and UI strings
  - Added `videoList` namespace with loading states and filter options
  - Added `videoSubmitForm` namespace with form labels and submission messages

### Features
- **Full i18n Support**: The videos page (`/videos`) is now fully localized in French and Spanish
- **Metadata Translation**: Page titles and descriptions are now translated for SEO
- **UI Components**: All videos-related UI text including filters, buttons, and form labels are translated
- **Consistent Pattern**: Uses same translation structure as the English (en.json) source

### Translation Coverage
- Page metadata (title, description)
- Main page title and description paragraphs
- Video list filters (All Stories, Female, Male, Detransitioners)
- Video submission form (URL input, labels, success/error messages)
- Individual video page elements (back button, overview, summary, watch on YouTube)
- Loading states and thumbnail alt text

## [2026-01-29] - Update Chat APIs and Components to Support Locale Parameter

### API Changes
- **Chat Conversations API** (`app/api/chat/conversations/[uuid]/route.ts`):
  - Updated GET endpoint to accept `locale` query parameter (e.g., `?locale=es`)
  - Returns `title` and `conversationSummary` already localized based on the requested locale
  - Added `getLocalizedField()` helper function to extract translations
  - Falls back to default text if translation doesn't exist for the requested locale
  - Still includes raw translation JSON fields (`titleTranslation`, `conversationSummaryTranslation`) for client-side access if needed
  - Example: `/api/chat/conversations/abc-123?locale=es` returns Spanish title and summary

- **Chat List API** (`app/api/chat/route.ts`):
  - Updated GET endpoint to accept `locale` query parameter
  - Added `titleTranslation` to the database SELECT query
  - Returns localized `title` and `conversationSummary` for each conversation in the list
  - Added `getLocalizedField()` helper function for server-side localization
  - Example: `/api/chat?featured=true&locale=es` returns Spanish titles and summaries

### Component Updates
- **FeaturedConversations Component** (`app/components/content/FeaturedConversations/FeaturedConversations.tsx`):
  - Added `useLocale` hook to get current locale
  - Updated `FeaturedConversation` interface to include `titleTranslation` field
  - Updated fetch call to include `locale` parameter in the API request
  - Now requests and receives already-localized conversation data from the server

- **ConversationsPage Component** (`app/components/content/ConversationsPage.tsx`):
  - Added `useLocale` hook to get current locale
  - Updated `ConversationSummary` interface to include `titleTranslation` field
  - Updated fetch call to include `locale` parameter in the API request
  - Updated toggleFeatured handler to include `titleTranslation` when updating local state

### Features
- **Server-Side Localization**: Clients can request conversation data in their preferred language
- **Clean API Response**: The API returns already-localized text instead of requiring clients to parse translation JSON
- **Consistent Pattern**: Both single conversation and conversation list APIs support locale parameter
- **Backward Compatible**: Default locale is "en" if no locale parameter provided

## [2026-01-29] - Add Tag Name Translation Support

### API Changes
- **Tags API** (`/api/tags/route.ts`):
  - Now returns `nameTranslation` field along with original tag names
  - Updated SELECT and GROUP BY clauses to include translation column

- **Users API** (`/api/users/route.ts`):
  - Tags are now returned as objects with `name` and `nameTranslation` fields
  - Changed from string array to array of tag objects
  - Updated tag grouping logic to preserve translation data

- **User Detail API** (`/api/users/[username]/route.ts`):
  - Tags now include `nameTranslation` field
  - Returns structured tag objects instead of simple strings

### Component Updates
- **UsersFilters Component** (`app/components/UsersFilters.tsx`):
  - Added `nameTranslation` to Tag interface
  - Added `getLocalizedTagName()` helper function to parse JSON translations
  - Tags are now displayed with localized names in the MultiSelect dropdown
  - Filter values still use original tag names for URL parameters
  - Selected tags display their localized names while maintaining original names in state

- **UserCard Component** (`app/components/UserCard.tsx`):
  - Updated Tag interface to include `nameTranslation` field
  - Added `getLocalizedTagName()` helper function
  - Tags now display localized names based on current locale
  - Falls back to original tag name if translation unavailable
  - Special handling for "suspicious account" tag preserved

- **User Detail Page** (`app/[locale]/stories/[username]/page.tsx`):
  - Updated Tag interface to match API response
  - Added `getLocalizedTagName()` helper function
  - Tags are now displayed with localized names
  - Badge variants still based on original tag names

### Features
- **Full Tag Translation Support**: Tag names can now be translated into all supported locales
- **Localized Filter Display**: Tag filter dropdown shows translated names
- **Preserved Filter Logic**: URL parameters and filtering still use original tag names
- **Consistent Pattern**: Uses same JSON translation storage pattern as other content

### Migration Notes
- Database migration required to add `name_translation` column to detrans_tags table
- Run migration: `npm run migrate` or `npx drizzle-kit migrate`
- Generate translations using: `npx tsx scripts/generate-tag-translations.ts`

## [2026-01-29] - Update Chat Conversations API to Return Localized Data

### API Changes
- **Chat Conversations API** (`app/api/chat/conversations/[uuid]/route.ts`):
  - Updated GET endpoint to accept `locale` query parameter (e.g., `?locale=es`)
  - Returns `title` and `conversationSummary` already localized based on the requested locale
  - Added `getLocalizedField()` helper function to extract translations
  - Falls back to default text if translation doesn't exist for the requested locale
  - Still includes raw translation JSON fields (`titleTranslation`, `conversationSummaryTranslation`) for client-side access if needed
  - Example: `/api/chat/conversations/abc-123?locale=es` returns Spanish title and summary

### Features
- **Server-Side Localization**: Clients can request conversation data in their preferred language
- **Clean API Response**: The API returns already-localized text instead of requiring clients to parse translation JSON
- **Backward Compatible**: Default locale is "en" if no locale parameter provided

## [2026-01-29] - Add Tag and User Translation Scripts

### Database Schema Changes
- **Detrans Tags Table**: Added new JSON translation column:
  - `name_translation` - Stores translations for tag names
  - Updated Zod schema (`tagSchema`) to include new `nameTranslation` field

### Scripts
- **Tag Translation Script** (`scripts/generate-tag-translations.ts`):
  - Generates translations for all tag names in the detrans_tags table
  - Scans all tags and identifies missing translations for configured locales
  - Uses DeepSeek AI to generate translations for missing locales
  - Supports all locales configured in `i18n/routing.ts`
  - Can be re-run when new locales are added
  - Stores translations as JSON objects in the database

- **User Translation Script** (`scripts/generate-user-translations.ts`):
  - Generates translations for user content fields:
    - `experience` - Full detransition stories
    - `experienceSummary` - User summary/about me text
    - `redFlagsReport` - Authenticity assessment reports
  - Scans all detrans users and identifies missing translations
  - Uses DeepSeek AI to generate translations for missing locales
  - Supports all locales configured in `i18n/routing.ts`
  - Can be re-run when new locales are added
  - Stores translations as JSON objects in respective translation columns

### Usage
```bash
# Generate translations for tags
npx tsx scripts/generate-tag-translations.ts

# Generate translations for user content
npx tsx scripts/generate-user-translations.ts
```

### Technical Details
- Both scripts follow the same pattern as existing translation scripts
- Implements exponential backoff for API resilience
- Only generates translations for missing locales (idempotent)
- Provides detailed progress logging
- Skips users without any content to translate

### Migration Notes
- Database migration required to add `name_translation` column to detrans_tags table
- Run migration: `npm run migrate` or `npx drizzle-kit migrate`

## [2026-01-29] - Fix Chat Conversations API to Return Title Translations

### API Changes
- **Chat Conversations API** (`app/api/chat/conversations/[uuid]/route.ts`):
  - Updated GET endpoint to include `titleTranslation` and `conversationSummaryTranslation` in the response
  - Updated `generateConversationTitleAndSummary()` function to generate title translations for all configured locales
  - Now returns both `titleTranslations` and `summaryTranslations` for each conversation
  - Updated PUT endpoint to store and return title translations when featuring conversations
  - Updated POST endpoint to store and return title translations when manually generating summaries
  - All endpoints now properly select and return translation columns from the database

### Bug Fixes
- **Missing Translation Fields**: The API was not returning `titleTranslation` and `conversationSummaryTranslation` fields, causing ConversationCard to always fall back to default titles
- **Translation Generation**: The conversations API now generates translations when creating/updating titles and summaries

## [2026-01-29] - Update Chat API to Generate Title Translations

### API Changes
- **Chat API** (`app/api/chat/[uuid]/route.ts`):
  - Updated `generateConversationTitleAndSummary()` function to generate title translations for all configured locales
  - Now returns both `titleTranslations` and `summaryTranslations` for each conversation
  - Title translations are generated using the same AI model (moonshotai/kimi-k2-0905:exacto) as summaries
  - Updated PUT endpoint to store title translations in the database when featuring conversations
  - Updated POST endpoint to store title translations when manually generating summaries
  - Both endpoints now set `titleTranslation` column with JSON object containing translations for all locales

### Features
- **Automatic Title Translation**: When a conversation is featured or a summary is manually generated, titles are now automatically translated into all supported locales
- **Consistent Translation Pattern**: Title translations follow the same pattern as summary translations, stored as JSON objects

### Technical Details
- Translations are generated sequentially to avoid rate limiting
- Fallback to English if translation generation fails for any locale
- Default locale (en) is set as the original title/summary without translation

## [2026-01-29] - Add Title Translation Support to Chat Conversations

### Database Schema Changes
- **Chat Conversations Table**: Added new JSON translation column:
  - `title_translation` - Stores translations for conversation titles
  - Updated Zod schema (`chatConversationSchema`) to include new `titleTranslation` field

### Component Updates
- **ConversationCard Component** (`app/components/content/ConversationCard/ConversationCard.tsx`):
  - Added `titleTranslation` prop to interface
  - Added `getLocalizedTitle()` helper function to parse JSON translations
  - Updated title display to use localized version based on current locale
  - Falls back to default title if translation unavailable

### Features
- **Full Translation Support**: Conversation titles can now be translated into all supported locales (en, es, fr)
- **Consistent Pattern**: Uses same JSON translation storage pattern as conversation summaries

### Migration Notes
- Database migration required to add `title_translation` column to chat_conversations table
- Run migration: `npm run migrate` or `npx drizzle-kit migrate`

## [2026-01-29] - Add Video and Chat Translation Scripts

### Scripts
- **Video Translation Script** (`scripts/generate-video-translations.ts`):
  - Generates translations for video fields: description, summary, and bite/tagline
  - Scans all videos in the database and identifies missing translations
  - Uses DeepSeek AI to generate translations for missing locales
  - Supports all locales configured in `i18n/routing.ts`
  - Can be re-run when new locales are added
  - Stores translations as JSON objects in the database

- **Chat Conversation Translation Script** (`scripts/generate-chat-translations.ts`):
  - Generates translations for conversation titles and summaries
  - Only processes conversations where `featured = true`
  - Scans featured conversations and identifies missing translations for both titles and summaries
  - Uses DeepSeek AI to generate translations for missing locales
  - Skips conversations without both summary and title
  - Supports all locales configured in `i18n/routing.ts`
  - Can be re-run when new locales are added
  - Stores title translations in `title_translation` column

### Usage
```bash
# Generate translations for videos
npx tsx scripts/generate-video-translations.ts

# Generate translations for featured chat conversations
npx tsx scripts/generate-chat-translations.ts
```

### Technical Details
- Both scripts follow the same pattern as `generate-study-translations.ts`
- Implements exponential backoff for API resilience
- Only generates translations for missing locales (idempotent)
- Provides detailed progress logging

## [2026-01-29] - Add Studies Migration and Translation Scripts

### Scripts
- **Migration Script** (`scripts/migrate-studies-to-db.ts`):
  - Migrates all 39 studies from the static page component (`app/[locale]/studies/page.tsx`) into the PostgreSQL database
  - Checks for existing studies by URL to prevent duplicates
  - Sets `processed: true` for all migrated studies since they are curated data
  - Provides detailed progress logging with success/skip/error counts

- **Translation Script** (`scripts/generate-study-translations.ts`):
  - Scans all studies in the database and identifies missing translations
  - Uses DeepSeek AI (via OpenRouter) to generate translations for missing locales
  - Supports all locales configured in `i18n/routing.ts` (currently en, es, fr)
  - Can be re-run when new locales are added to generate translations for the new languages
  - Translates: headline, title, description, and journal fields
  - Implements rate limiting and backoff to avoid API limits
  - Preserves existing translations and only fills in missing ones

### Features
- **Incremental Translation Updates**: The translation script checks which locales already have translations and only generates missing ones
- **Configurable Locales**: Adding a new locale to `i18n/routing.ts` automatically enables translation generation for that locale
- **Idempotent Operations**: Both scripts can be safely run multiple times without creating duplicates

### Usage
```bash
# Migrate studies from page component to database
npx tsx scripts/migrate-studies-to-db.ts

# Generate translations for all configured locales
npx tsx scripts/generate-study-translations.ts
```

### Technical Details
- Uses `drizzle-orm` for database operations
- Uses OpenAI SDK with OpenRouter base URL for AI translations
- Implements exponential backoff for API resilience
- Stores translations as JSON objects in the database

## [2026-01-29] - Remove Authors Translation from Studies

### Database Schema Changes
- **Studies Table**: Removed `authors_translation` column
  - Author names should not be translated as they are proper nouns
  - Simplifies translation logic for studies content
- Updated Zod schema (`studySchema`) to remove `authorsTranslation` field

### Migration Notes
- Database migration required to drop `authors_translation` column from studies table
- Existing author translations (if any) will be removed

## [2026-01-29] - Add Automatic Browser Locale Detection

### Features
- **Automatic Locale Detection**: The application now automatically detects the user's preferred language from their browser settings
- **Smart Locale Matching**: Parses the `Accept-Language` header and matches it to supported locales (en, es, fr)
- **Language Code Fallback**: Supports both exact matches (e.g., "en-US" → "en") and language code matching (e.g., "fr-CA" → "fr")
- **Quality Score Support**: Respects browser language preferences with quality scores (e.g., "en;q=0.9,fr;q=0.8")

### Technical Details
- **New Utility Function** (`i18n/detect-locale.ts`):
  - `detectBrowserLocale()` function parses Accept-Language headers
  - Returns best matching locale from supported list
  - Falls back to default locale if no match found

- **Middleware Updates** (`middleware.ts`):
  - Detects when requests don't have a locale prefix in the URL
  - Uses browser's Accept-Language header to determine preferred locale
  - Redirects to locale-prefixed URL (e.g., `/chat` → `/es/chat` for Spanish users)
  - Logs locale detection for debugging purposes

### Supported Locales
Currently supports: English (en), Spanish (es), French (fr)
Easily extensible by adding more locales to `i18n/routing.ts`

## [2026-01-29] - Add Translations for Deep Research Events Component

### Components
- **Data UI Events Component** (`components/detrans/data-ui_event.jsx`):
  - Added `useTranslations` hook from next-intl for internationalization
  - Replaced all hardcoded English strings with translation keys
  - Added support for dynamic text interpolation using `t()` function

### Translation Additions
- **English (en.json)**:
  - Added `deepResearchEvents` namespace with 11 translation keys:
    - `errorTitle`, `retrieving`, `generatingQuestions`, `findingAnswers`, `completed`
    - `retrieveError`, `analyzeError`, `generatingAnswer`, `waitingForAnswer`
    - `questionsAnswered` (with interpolation), `generatingSummary`

- **Spanish (es.json)**:
  - Added complete Spanish translations for all deep research events strings

- **French (fr.json)**:
  - Added complete French translations for all deep research events strings

### Features
- **Full i18n Support**: Deep research status messages, error messages, and progress indicators are now fully localized
- **Dynamic Interpolation**: Questions answered counter uses translation parameters (`{answered}`, `{total}`)
- **Consistent Pattern**: Uses same `useTranslations` pattern as other client components

## [2026-01-29] - Detrans User Content Translations

### Database Schema Changes
- **Detrans Users Table**: Added three new JSON translation columns:
  - `experience_translation` - Stores translations for full detransition stories
  - `experience_summary_translation` - Stores translations for user summary/about me text
  - `red_flags_report_translation` - Stores translations for authenticity assessment reports
- Updated Zod schemas (`detransUserSchema`) to include new translation fields

### API Changes
- **Users API** (`/api/users/route.ts`):
  - Added `experienceSummaryTranslation` to SELECT and GROUP BY clauses
  - Returns translation data for user listings

- **User Detail API** (`/api/users/[username]/route.ts`):
  - Added all three translation fields to SELECT and GROUP BY clauses
  - Returns translation data for individual user pages

### Component Updates
- **UserCard Component** (`/app/components/UserCard.tsx`):
  - Added `experienceSummaryTranslation` to User interface
  - Added `getLocalizedField()` helper function to parse JSON translations
  - Updated to display localized experience summary based on current locale
  - Falls back to default English text if translation unavailable

- **User Story Page** (`/[locale]/stories/[username]/page.tsx`):
  - Added all translation fields to User interface
  - Added `getLocalizedField()` helper function
  - Updated `generateMetadata` to use localized experience summary for SEO
  - Updated page to display localized versions of:
    - Experience Summary ("About me" section)
    - Full Experience ("My detransition story" section)
    - Red Flags Report ("Authenticity Assessment" section)

### Features
- **Full Translation Support**: User content can now be translated into all supported locales (en, es, fr)
- **SEO Localization**: Meta descriptions and OpenGraph tags now use localized content
- **Fallback Support**: All displays fall back to English if translation not available
- **Consistent Pattern**: Uses same JSON translation storage pattern as videos and conversations

### Technical Details
- Translations stored as JSON objects: `{"en": "...", "es": "...", "fr": "..."}`
- Client-side localization using `useLocale()` from next-intl
- Server-side components receive locale from URL parameters
- Type-safe implementation with TypeScript interfaces

## [2026-01-29] - Fix Missing Translation Keys for Question Tabs

### Bug Fixes
- **Question Tabs Component** (`app/components/content/QuestionTabs.tsx`):
  - Fixed French translation namespace `questionTabs` that was missing from `messages/fr.json`
  - Fixed Spanish translation namespace `questionTabs` that was missing from `messages/es.json`

### Translation Additions
- **French (fr.json)**:
  - Added `questionTabs.topics`: "Sujets"
  - Added `questionTabs.generated`: "Générés"
  - Added `questionTabs.recent`: "Récents"
  - Added `questionTabs.top`: "Populaires"

- **Spanish (es.json)**:
  - Added `questionTabs.topics`: "Temas"
  - Added `questionTabs.generated`: "Generados"
  - Added `questionTabs.recent`: "Recientes"
  - Added `questionTabs.top`: "Populares"

## [2026-01-29] - Video and Conversation Translations

### Database Schema Changes
- **Videos Table**: Added three new JSON translation columns:
  - `description_translation` - Stores translations for video descriptions
  - `summary_translation` - Stores translations for video summaries
  - `bite_translation` - Stores translations for video taglines/bites
- **Chat Conversations Table**: Added translation support:
  - `conversation_summary_translation` - Stores translations for conversation summaries
- Updated Zod schemas to include new translation fields

### API Changes
- **Video API** (`/api/videos/route.ts`):
  - Added `locale` query parameter support
  - Returns localized `description`, `summary`, and `bite` fields based on locale
  - Falls back to default English if translation not available

- **Chat API** (`/api/chat/[uuid]/route.ts`):
  - AI now generates translations for all configured locales when creating conversation summaries
  - Supports dynamic locale list from i18n routing configuration
  - Stores translations as JSON object: `{"en": "...", "es": "...", "fr": "..."}`
  - Added `getLanguageName()` utility function to map locale codes to full language names

### Component Updates
- **Video Components**:
  - `VideoList.tsx` - Fetches and displays videos with locale-specific translations
  - `SeoVideosList.tsx` - Server component now passes locale and displays localized content
  - Video detail page (`/[locale]/videos/[slug]/page.tsx`) - Displays localized description, summary, and bite

- **Conversation Components**:
  - `ConversationCard.tsx` - Now displays localized summaries based on user's locale
  - `ConversationsPage.tsx` - Updated interface and passes translation data to ConversationCard
  - `FeaturedConversations.tsx` - Updated to handle and pass translation props
  - `ConversationDialog.tsx` - Displays localized conversation summary in dialog header
  - `chat-section.tsx` - Loads and displays localized conversation summaries

### Internationalization
- **New Utility Function** (`i18n/routing.ts`):
  - Added `getLanguageName()` function mapping locale codes to full language names
  - Supports 70+ languages for future expansion

### Features
- **Automatic Translation Generation**: When a conversation is marked as featured or a summary is manually generated, the system automatically creates translations for all configured locales (en, es, fr)
- **Dynamic Locale Support**: Adding new languages to `i18n/routing.ts` automatically enables translation generation for those locales
- **Fallback Support**: All translation displays fall back to English if a translation is not available for the user's locale

### Technical Details
- Translations stored as JSON strings in database columns
- Client-side localization using `navigator.language` for browser detection
- Server-side components receive locale from URL parameters
- Type-safe implementation using TypeScript interfaces

## Migration Notes
To use the new translation features:
1. Run database migrations to add new columns
2. Existing data will need translations added manually or regenerated
3. Conversation summaries will automatically generate translations when featured
